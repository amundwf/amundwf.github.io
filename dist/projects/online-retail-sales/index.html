<!DOCTYPE html><html lang="en" class="antialiased break-words"> <head><!-- High Priority Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Online retail sales analysis | Amund Fredriksen</title><meta name="generator" content="Astro v4.11.3"><!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><!-- <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400..700&family=Newsreader:ital,opsz,wght@0,6..72,400..700;1,6..72,400..700&display=swap"
    rel="stylesheet"
/> --><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400..700&family=Newsreader:ital,opsz,wght@0,6..72,400..700;1,6..72,400..700&display=swap" rel="stylesheet"><!-- Low Priority Global Metadata --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="RSS"><!-- Page Metadata --><link rel="canonical" href="https://example.com/projects/online-retail-sales/"><meta name="description" content="Analysis of sales data from an online retail business"><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://example.com/projects/online-retail-sales/"><meta property="og:title" content="Online retail sales analysis | Amund Fredriksen"><meta property="og:description" content="Analysis of sales data from an online retail business"><meta property="og:image" content="https://example.com/project_online-retail-sales/online_retail_sales_preview.jpg"><!-- X/Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://example.com/projects/online-retail-sales/"><meta property="twitter:title" content="Online retail sales analysis | Amund Fredriksen"><meta property="twitter:description" content="Analysis of sales data from an online retail business"><meta property="twitter:image" content="https://example.com/project_online-retail-sales/online_retail_sales_preview.jpg"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_slug_.zNknd2Ul.css"><script type="module" src="/_astro/hoisted.Dc_NH-7Y.js"></script></head> <body class="bg-main text-main"> <div class="flex flex-col min-h-screen px-4 md:px-8"> <nav class="min-h-10 pt-4 pb-12 relative sm:min-h-14 sm:pb-24 md:pt-8" data-astro-cid-dmqpwcec> <div class="w-full max-w-3xl mx-auto relative" data-astro-cid-dmqpwcec> <button class="menu-toggle w-8 h-8 -ml-1 flex items-center justify-center relative z-30 md:hidden" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items" data-astro-cid-dmqpwcec> <span class="menu-toggle-icon w-6 h-px relative bg-current" data-astro-cid-dmqpwcec></span> </button> <ul id="menu-items" class="menu flex gap-6" data-astro-cid-dmqpwcec> <li class="py-1" data-astro-cid-dmqpwcec> <a class="text-xl font-sans text-main hover:underline hover:underline-offset-2 hover:decoration-1 md:text-base" href="/" data-astro-cid-dmqpwcec> Home </a> </li><li class="py-1" data-astro-cid-dmqpwcec> <a class="text-xl font-sans text-main hover:underline hover:underline-offset-2 hover:decoration-1 md:text-base" href="/about" data-astro-cid-dmqpwcec> About </a> </li><li class="py-1" data-astro-cid-dmqpwcec> <a class="text-xl font-sans text-main hover:underline hover:underline-offset-2 hover:decoration-1 md:text-base" href="/projects" data-astro-cid-dmqpwcec> Projects </a> </li> </ul> </div> <div class="absolute right-0 top-4 z-10 md:top-8" data-astro-cid-dmqpwcec> <button id="theme-toggle" class="w-8 h-8 -mr-2 flex items-center justify-center" aria-label="Change color scheme"> <svg class="w-4 h-4 fill-current" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"> <circle cx="8" cy="8" r="8"></circle> </svg> </button> <!-- <button id="theme-toggle" class="w-12 h-12 -mr-2 flex items-center justify-center" aria-label="Change color scheme">
    <svg class="w-5 h-5 fill-current" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <circle cx="8" cy="8" r="9"></circle>
    </svg>
</button> --> <!-- <button id="theme-toggle" class="w-8 h-8 -mr-2 flex items-center justify-center" aria-label="Change color scheme">
    <svg class="w-4 h-4 fill-current" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <circle cx="8" cy="8" r="8" fill="currentColor" />
        <path d="M0,8 a8,8 0 0,0 16,0 a8,8 0 0,0 -16,0" fill="white" />
    </svg>
</button> -->   </div> </nav>    <main class="grow w-full max-w-3xl mx-auto">  <article class="mb-16 sm:mb-24"> <header class="mb-8"> <!-- <h1 class="text-3xl leading-tight font-serif font-medium sm:text-5xl sm:leading-tight">{title}</h1> --> <h1 class="text-3xl leading-tight font-sans font-medium sm:text-5xl sm:leading-tight">Online retail sales analysis</h1> </header> <!-- <div class="max-w-none prose prose-dante sm:prose-lg"> --> <div class="max-w-none prose-dante sm:prose-lg"> <p><img src="/project_online-retail-sales/online_retail_sales_preview.jpg" alt="Project preview"></p>
<p><strong>Project overview:</strong>
In this project I analyze a dataset of the sales for an online retail company over two years. I use SQL to retrieve specific information that will be useful for analysis purposes, and then I identify some trends in the sales data and create a dashboard in Power BI for visualization. I show most of the whole process rather than only presenting the results.</p>
<p>This project was my first encounter with SQL and Power BI. I used a combination of online tutorials, documentation, and ChatGPT for learning these tools. I used ChatGPT extensively (and shamelessly ðŸ˜‡) for creating SQL queries as well as for understanding how they worked, to speed up the query writing and the learning process.</p>
<p>This project was done on a PC running Windows. The software I used was the following:</p>
<ul>
<li>For setting up a local SQL server: <em>SQL Server 2022 Configuration Manager</em></li>
<li>For querying the SQL database: <em>Microsoft SQL Server Management Studio 19</em> (SSMS)</li>
<li>For data visualization: <em>Microsoft Power BI</em></li>
</ul>
<h2 id="the-data-set">The data set</h2>
<p>This dataset includes all transactions for a UK-based online retail company, operating without a physical store, from December 2009 to December 2011. The company specializes in giftware. Many of its customers are wholesalers.</p>
<p>I found the dataset at Kaggle, provided by the user Lakshmipathi N. (<a class="link" href="https://www.kaggle.com/datasets/lakshmi25npathi/online-retail-dataset">link</a>). Primary source of the dataset: Dr. Daqing Chen, Course Director: M.Sc. Data Science, School of Engineering, London South Bank University.</p>
<h2 id="data-exploration">Data exploration</h2>
<!-- show some of the table -->
<p>Importing the two data sheets (2009-2010 and 2010-2011) into SSMS:
<img src="/project_online-retail-sales/img1.png" alt="Importing data into SSMS"></p>
<p>Description of the columns of the data set:</p>
<ul>
<li>Invoice: A 6-digit code uniquely assigned to each transaction. If the code starts with the letter â€˜Câ€™, it indicates a cancellation.</li>
<li>StockCode: Product code.</li>
<li>Description: Product name.</li>
<li>Quantity: The quantities of each product per transaction.</li>
<li>InvoiceDate: Invoice date and time.</li>
<li>Price: Product price per unit in British pounds (Â£).</li>
<li>CustomerID: A 5-digit number uniquely assigned to each customer.</li>
<li>Country: The name of the country where the customer lives.</li>
</ul>
<p>The data consists of two data sheets, roughly one year of sales data each. The total number of rows in tables 1 and 2 is 525 461 and 541 910 respectively.</p>
<p>Now jumping into some SQL querying for data exploration. For a quick overview, selecting the first rows of one of the tables:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> TOP</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">1000</span><span style="color:#E1E4E8">) [Invoice]</span></span>
<span class="line"><span style="color:#E1E4E8">       ,[StockCode]</span></span>
<span class="line"><span style="color:#E1E4E8">       ,[Description]</span></span>
<span class="line"><span style="color:#E1E4E8">       ,[Quantity]</span></span>
<span class="line"><span style="color:#E1E4E8">       ,[InvoiceDate]</span></span>
<span class="line"><span style="color:#E1E4E8">       ,[Price]</span></span>
<span class="line"><span style="color:#E1E4E8">       ,[Customer_ID]</span></span>
<span class="line"><span style="color:#E1E4E8">       ,[Country]</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[online_retail_II_2009-2010]</span></span>
<span class="line"></span></code></pre>
<p>which results in this output table (only part of it is shown here):</p>
<p><img src="/project_online-retail-sales/img2-2.png" alt="Top rows of one of the data tables"></p>
<p>Checking for null values in both tables:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> *</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> sales_2009_2010</span></span>
<span class="line"><span style="color:#F97583">WHERE</span></span>
<span class="line"><span style="color:#E1E4E8">    Invoice </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    StockCode </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#F97583">    Description</span><span style="color:#F97583"> IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Quantity </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    InvoiceDate </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Price </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Customer_ID </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Country </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#F97583"> Description</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> *</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> sales_2010_2011</span></span>
<span class="line"><span style="color:#F97583">WHERE</span></span>
<span class="line"><span style="color:#E1E4E8">    Invoice </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    StockCode </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#F97583">    Description</span><span style="color:#F97583"> IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Quantity </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    InvoiceDate </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Price </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Customer_ID </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> OR</span></span>
<span class="line"><span style="color:#E1E4E8">    Country </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#F97583"> Description</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span></code></pre>
<p>Which gives the following output:
<img src="/project_online-retail-sales/img3.png" alt="Null values"></p>
<p>Now, counting the number of null values for different columns:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Invoice </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Invoices,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> StockCode </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_StockCodes,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#F97583"> Description</span><span style="color:#F97583"> IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Descriptions,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Quantities,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> InvoiceDate </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_InvoiceDates,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Prices,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Customer_ID </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Customer_IDs,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Country </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Countries</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    sales_2009_2010;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Invoice </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Invoices,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> StockCode </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_StockCodes,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#F97583"> Description</span><span style="color:#F97583"> IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Descriptions,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Quantities,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> InvoiceDate </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_InvoiceDates,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Prices,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Customer_ID </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Customer_IDs,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Country </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Null_Countries</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    sales_2010_2011;</span></span>
<span class="line"></span></code></pre>
<p><img src="/project_online-retail-sales/img4.png" alt="Number of null values in each column in the two tables"></p>
<p>We see that there are the most null values in the CustomerID column, with 107927 null values and 135080 null values in the first and second tables respectively (20-25% of the total amount of rows). There is also a notable amount of null values in the Description column, with 2928 null values and 1454 null values in the first and second tables respectively. <!-- There is also a notable amount of null values in the Description column, with 2928 null values (â‰ˆ0.5% of the rows) and 1454 null values (â‰ˆ0.25% of the rows) in the first and second tables respectively.  -->
The CustomerID nulls could maybe be due to guest checkouts, data entry errors or some account privacy settings. Iâ€™m more uncertain about the description nulls, but one possibility is that their product listings are incomplete. Potentially that they have added items to their online store without having added descriptions for those items yet.</p>
<p>Further exploration: Counting positive, zero and negative values for Price and Quantity:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">    positivePrices,</span></span>
<span class="line"><span style="color:#E1E4E8">	zeroPrices,</span></span>
<span class="line"><span style="color:#E1E4E8">	negativePrices,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">	positiveQuantity,</span></span>
<span class="line"><span style="color:#E1E4E8">	zeroQuantity,</span></span>
<span class="line"><span style="color:#E1E4E8">	negativeQuantity,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    max_rowID</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#F97583">    SELECT</span></span>
<span class="line"><span style="color:#79B8FF">        COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> positivePrices,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> zeroPrices,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> negativePrices,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> positiveQuantity,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> zeroQuantity,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> negativeQuantity,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">        MAX</span><span style="color:#E1E4E8">(rowID) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> max_rowID</span></span>
<span class="line"><span style="color:#F97583">    FROM</span></span>
<span class="line"><span style="color:#E1E4E8">        [SalesDataAnalysis].[dbo].[sales_2009_2010]</span></span>
<span class="line"><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> subquery;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8">    positivePrices,</span></span>
<span class="line"><span style="color:#E1E4E8">	zeroPrices,</span></span>
<span class="line"><span style="color:#E1E4E8">	negativePrices,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">	positiveQuantity,</span></span>
<span class="line"><span style="color:#E1E4E8">	zeroQuantity,</span></span>
<span class="line"><span style="color:#E1E4E8">	negativeQuantity,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    max_rowID</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#F97583">    SELECT</span></span>
<span class="line"><span style="color:#79B8FF">        COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> positivePrices,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> zeroPrices,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Price </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> negativePrices,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> positiveQuantity,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> zeroQuantity,</span></span>
<span class="line"><span style="color:#79B8FF">		COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">CASE</span><span style="color:#F97583"> WHEN</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> THEN</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> END</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> negativeQuantity,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">        MAX</span><span style="color:#E1E4E8">(rowID) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> max_rowID</span></span>
<span class="line"><span style="color:#F97583">    FROM</span></span>
<span class="line"><span style="color:#E1E4E8">        [SalesDataAnalysis].[dbo].[sales_2010_2011]</span></span>
<span class="line"><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> subquery;</span></span>
<span class="line"></span></code></pre>
<p><img src="/project_online-retail-sales/img5.png" alt="Number of positive, zero and negative values for Price and Quantity"></p>
<p>The negative Quantity values seem to correspond to cancellations in most or all cases.</p>
<p>In some cases it will be useful to have only entries with positive Quantity. This filters out cancellations.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> *</span></span>
<span class="line"><span style="color:#F97583">INTO</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2009_2010_filtered]</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2009_2010]</span></span>
<span class="line"><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> *</span></span>
<span class="line"><span style="color:#F97583">INTO</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2010_2011_filtered]</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2010_2011]</span></span>
<span class="line"><span style="color:#F97583">WHERE</span><span style="color:#E1E4E8"> Quantity </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span></code></pre>
<p>Further exploration: Finding the number of unique invoice numbers for each year. For this I use the filtered list without the cancellations.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Invoice) </span><span style="color:#F97583">AS</span><span style="color:#9ECBFF"> "Total unique invoices 2009-2010"</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2009_2010_filtered];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#79B8FF"> COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Invoice) </span><span style="color:#F97583">AS</span><span style="color:#9ECBFF"> "Total unique invoices 2010-2011"</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2010_2011_filtered];</span></span>
<span class="line"></span></code></pre>
<p><img src="/project_online-retail-sales/img6.png" alt="Number of unique invoices"></p>
<p>Note that these results are not exact representations of the number of invoices in the two years, as there is some days of overlap between the data sheets of the first and second year. These queries are mainly to get a rough overview of the data.</p>
<h2 id="data-cleaning">Data cleaning</h2>
<p>The overlap between the two data tables is a bit inconvenient. It can be seen here:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> *</span><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2009_2010_filtered]</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> InvoiceDate, StockCode;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> *</span><span style="color:#F97583"> FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2010_2011_filtered]</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> InvoiceDate, StockCode;</span></span>
<span class="line"></span></code></pre>
<p><img src="/project_online-retail-sales/img7-2.png" alt="Tables overlap">
Here I have navigated to the overlap area. The overlap begins toward the end of the first table and from the first row of the second table. Now I merge the two tables into a single table in order to avoid overcounting items/orders.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Invoice,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> StockCode,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Description</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Description</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Description</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Quantity</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Quantity</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Quantity,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> InvoiceDate,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Price</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Price</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Price,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Customer_ID</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Customer_ID</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Customer_ID,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Country</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Country</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Country</span></span>
<span class="line"><span style="color:#F97583">INTO</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_combined_2009_2011]</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2009_2010_filtered] a</span></span>
<span class="line"><span style="color:#F97583">FULL OUTER JOIN</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2010_2011_filtered] b</span></span>
<span class="line"><span style="color:#F97583">ON</span><span style="color:#79B8FF"> a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#F97583"> AND</span><span style="color:#79B8FF"> a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#F97583"> AND</span><span style="color:#79B8FF"> a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span></span>
<span class="line"></span></code></pre>
<p>Iâ€™m also keeping an unfiltered combined table â€˜sales_combined_2009_2011_unfilteredâ€™, in case we want to work with all of the data including negative quantities.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Invoice,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> StockCode,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Description</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Description</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Description</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Quantity</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Quantity</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Quantity,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> InvoiceDate,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Price</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Price</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Price,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Customer_ID</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Customer_ID</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Customer_ID,</span></span>
<span class="line"><span style="color:#79B8FF">    COALESCE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Country</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Country</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> Country</span></span>
<span class="line"><span style="color:#F97583">INTO</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2009_2010] a</span></span>
<span class="line"><span style="color:#F97583">FULL OUTER JOIN</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_2010_2011] b</span></span>
<span class="line"><span style="color:#F97583">ON</span><span style="color:#79B8FF"> a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">Invoice</span><span style="color:#F97583"> AND</span><span style="color:#79B8FF"> a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">StockCode</span><span style="color:#F97583"> AND</span><span style="color:#79B8FF"> a</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> b</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">InvoiceDate</span></span>
<span class="line"></span></code></pre>
<p>The reason for joining the tables on <code>a.Invoice = b.Invoice AND a.StockCode = b.StockCode AND a.InvoiceDate = b.InvoiceDate</code> is to make sure that the join statement correctly joins elements that are from the exact same item in the same order.</p>
<p>Now, add a primary key to the new combined table:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">ALTER</span><span style="color:#F97583"> TABLE</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">ADD</span><span style="color:#E1E4E8"> rowID </span><span style="color:#F97583">INT</span><span style="color:#79B8FF"> IDENTITY</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">ALTER</span><span style="color:#F97583"> TABLE</span><span style="color:#E1E4E8"> [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">ADD</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8"> (rowID);</span></span>
<span class="line"></span></code></pre>
<h2 id="data-analysis">Data analysis</h2>
<p>First we can investigate monthly sales trends. We can look at total revenue, total number of orders/invoices, total quantity of items sold and number of unique customers each month. The following query was used:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#6A737D">-- Total revenue for each month</span></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Year</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    MONTH</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Month</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(Quantity </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Price) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalRevenue</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate), </span><span style="color:#79B8FF">MONTH</span><span style="color:#E1E4E8">(InvoiceDate)</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    Year</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">Month</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- Total number of orders/invoices for each month</span></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Year</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    MONTH</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Month</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Invoice) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalInvoices</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate), </span><span style="color:#79B8FF">MONTH</span><span style="color:#E1E4E8">(InvoiceDate)</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    Year</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">Month</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- Total quantity of items sold for each month</span></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Year</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    MONTH</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Month</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(Quantity) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalSoldQuantity</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate), </span><span style="color:#79B8FF">MONTH</span><span style="color:#E1E4E8">(InvoiceDate)</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    Year</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">Month</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- Number of unique customers (by Customer_ID) for each month</span></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Year</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    MONTH</span><span style="color:#E1E4E8">(InvoiceDate) </span><span style="color:#F97583">AS</span><span style="color:#F97583"> Month</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Customer_ID) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> UniqueCustomers</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    YEAR</span><span style="color:#E1E4E8">(InvoiceDate), </span><span style="color:#79B8FF">MONTH</span><span style="color:#E1E4E8">(InvoiceDate)</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    Year</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">Month</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span></code></pre>
<p>The resulting tables from this query are saved to spreadsheet files in the <code>.csv</code> format for visualization later. The following additional information was also found:</p>
<p>Top selling products:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#6A737D">-- Get the top 100 selling products</span></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#F97583"> TOP</span><span style="color:#79B8FF"> 100</span></span>
<span class="line"><span style="color:#F97583">    Description</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(Quantity) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalQuantitySold</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#79B8FF">    SalesDataAnalysis</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">dbo</span><span style="color:#E1E4E8">.sales_combined_2009_2011_unfiltered</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">    Description</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    TotalQuantitySold </span><span style="color:#F97583">DESC</span></span>
<span class="line"></span></code></pre>
<p>Customer segmentation (which customers spend the most): <!-- Analyze customer purchasing behavior by identifying the top spending customers. --></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#6A737D">-- Order by total money spent (by each of the customers)</span></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Customer_ID,</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(Quantity </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Price) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalMoneySpent,</span></span>
<span class="line"><span style="color:#79B8FF">	COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Invoice) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> NumberOfOrders</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Customer_ID</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    TotalMoneySpent </span><span style="color:#F97583">DESC</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- Order by number of orders (of each of the customers)</span></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Customer_ID,</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(Quantity </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Price) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalMoneySpent,</span></span>
<span class="line"><span style="color:#79B8FF">	COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Invoice) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> NumberOfOrders</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Customer_ID</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    NumberOfOrders </span><span style="color:#F97583">DESC</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span></code></pre>
<p>Top spending countries:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Country,</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(Quantity </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Price) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalSales,</span></span>
<span class="line"><span style="color:#79B8FF">	COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Invoice) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> UniqueInvoices</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Country</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    TotalSales </span><span style="color:#F97583">DESC</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">SELECT</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Country,</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(Quantity </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> Price) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> TotalSales,</span></span>
<span class="line"><span style="color:#79B8FF">	COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">DISTINCT</span><span style="color:#E1E4E8"> Invoice) </span><span style="color:#F97583">AS</span><span style="color:#E1E4E8"> UniqueInvoices</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    [SalesDataAnalysis].[dbo].[sales_combined_2009_2011_unfiltered]</span></span>
<span class="line"><span style="color:#F97583">GROUP BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    Country</span></span>
<span class="line"><span style="color:#F97583">ORDER BY</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    UniqueInvoices </span><span style="color:#F97583">DESC</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span></code></pre>
<h2 id="data-visualization-and-insights">Data visualization and insights</h2>
<!-- Now I will create a data visualization in Power BI in order to get more insights about the data we've worked with.  -->
<p>Now I will create a data visualization in Power BI. This will help us make sense of what weâ€™ve found so far in a more accessible way.</p>
<p>I import the combined, unfiltered data table, as well as all the resulting tables from the data analysis above, into Power BI.</p>
<p>I create a new column in order to get a more workable time format for the months and years. Here is how: Power BI Desktop Home tab â†’ Transform data â†’ Transform data (opens Power Query Editor) â†’ In Power Query Editor: Add Column â†’ Custom Column â†’ In the â€˜Custom column formulaâ€™ field, enter: <code>=Text.From([Year]) &#x26; "-" &#x26; Text.PadStart(Text.From([Month]), 2, "0")</code>.</p>
<!-- (This is the Power Query M formula language.) -->
<p>I added the following elements to the dashboard:</p>
<p>Visualization: Quantity and Revenue by Country. I also added a drill-down option for Description (item description) in order to see which items were sold the most for each country.</p>
<p>Visualization: Invoices, Unique customers, Quantity (all items) and Revenue by Date. Two y-axes for the different scales (invoices and unique customers on one side, and quantity and revenue on the other side).</p>
<p>Visualization: Card showing average monthly revenue.
I excluded the first and last months since they were not full months in the dataset. The DAX query I used to calculate the monthly revenue is the following:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="dax"><code><span class="line"><span style="color:#79B8FF">AverageMonthlyRevenue</span><span style="color:#F97583"> =</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">VAR</span><span style="color:#79B8FF"> totalRevenueExclFirstAndLastMonths</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> CALCULATE</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#79B8FF">    SUM</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">monthlySalesTrends[TotalRevenue]</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#79B8FF">    FILTER</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">monthlySalesTrends</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">monthlySalesTrends[Date]</span><span style="color:#F97583"> &#x3C;></span><span style="color:#9ECBFF"> "2009-12"</span><span style="color:#F97583"> &#x26;&#x26;</span><span style="color:#79B8FF"> monthlySalesTrends[Date]</span><span style="color:#F97583"> &#x3C;></span><span style="color:#9ECBFF"> "2011-12"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">VAR</span><span style="color:#79B8FF"> selectedNumberOfMonths</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> CALCULATE</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#79B8FF">    COUNT</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">monthlySalesTrends[Month]</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#79B8FF">    FILTER</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">monthlySalesTrends</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">monthlySalesTrends[Date]</span><span style="color:#F97583"> &#x3C;></span><span style="color:#9ECBFF"> "2009-12"</span><span style="color:#F97583"> &#x26;&#x26;</span><span style="color:#79B8FF"> monthlySalesTrends[Date]</span><span style="color:#F97583"> &#x3C;></span><span style="color:#9ECBFF"> "2011-12"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">VAR</span><span style="color:#79B8FF"> avgMonthlyRevenue</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> DIVIDE</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">totalRevenueExclFirstAndLastMonths</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">selectedNumberOfMonths</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- Format avgMonthlyRevenue so that it is displayed with an appropriate number of digits</span></span>
<span class="line"><span style="color:#F97583">VAR</span><span style="color:#79B8FF"> avgMonthlyRevenue_formatted</span><span style="color:#F97583"> =</span></span>
<span class="line"><span style="color:#79B8FF">    SWITCH</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#79B8FF">        TRUE</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#79B8FF">        ABS</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">avgMonthlyRevenue</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">>=</span><span style="color:#79B8FF"> 1000000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">FORMAT</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">avgMonthlyRevenue</span><span style="color:#F97583"> /</span><span style="color:#79B8FF"> 1000000</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"0.##"</span><span style="color:#E1E4E8">) &#x26; </span><span style="color:#9ECBFF">"M"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">        ABS</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">avgMonthlyRevenue</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">>=</span><span style="color:#79B8FF"> 100000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">FORMAT</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">avgMonthlyRevenue</span><span style="color:#F97583"> /</span><span style="color:#79B8FF"> 1000</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"0"</span><span style="color:#E1E4E8">) &#x26; </span><span style="color:#9ECBFF">"K"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">        ABS</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">avgMonthlyRevenue</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">>=</span><span style="color:#79B8FF"> 1000</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">FORMAT</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">avgMonthlyRevenue</span><span style="color:#F97583"> /</span><span style="color:#79B8FF"> 1000</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"0.#"</span><span style="color:#E1E4E8">) &#x26; </span><span style="color:#9ECBFF">"K"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">        FORMAT</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">avgMonthlyRevenue</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"0"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">RETURN</span><span style="color:#79B8FF"> avgMonthlyRevenue_formatted</span></span>
<span class="line"></span></code></pre>
<p>Lastly, I added slicers for Year and Month, so that the data can be shown for specific years/months.</p>
<p>The image at the beginning of this post was indeed this dashboard. Showing it again here:
<img src="/project_online-retail-sales/online_retail_sales_preview.jpg" alt="Dashboard screenshot"></p>
<p>Letâ€™s get an overview of the dashboard.
We see a plot with info about sold quantity, revenue, and counts of invoices and unique customers for each month. With the added slicer we can look at the specific months weâ€™re interested in.
The graph on the right-hand side shows the quantity of items sold and revenue in total, added up over the entire data set, grouped by country. I added the option of drilling down on each country, revealing how much was sold of each item to customers from that country.
Thereâ€™s a card displaying the average monthly revenue at the bottom left. This average is calculated for the selected months.
The other card displays the cancellation rate in total over the entire data set. <!-- , which is seen to be 18%.   --></p>
<p>By looking at the graph for revenue we can see somewhat of a pattern in the sales over a year. November is seen to be the month with the highest revenue in both years registered. The average monthly revenue including all months is 776K. The average November revenue is Â£1.44M. If we exclude the final quarter of the year (months 9-12), the average monthly revenue drops to Â£636K. A natural explanation of this could be that many people are doing gift shopping for Christmas in the months leading up to Christmas.
When we look at the Countries visualization, we see that by far the largest amount of customers come from the UK. The UK is very much a Christmas-celebrating country (or countries, depending on how you look at it), so this is consistent with the idea that sales spike in November because of Christmas shopping.</p>
<!-- Exploring the dashboard to see some more concrete sales info, we can look at the sales for a couple of countries:  -->
<p>Letâ€™s get completely specific and look closer at the sales info for a couple of countries.
For example, drilling down on the UK, we see that the two highest revenue items there are (excluding postage/shipping) a cakestand and a tea light holder:
<img src="/project_online-retail-sales/Country-drill-down-UK.PNG" alt="Drill down UK"></p>
<p>And when drilling down on Norway, we see that the two highest revenue items are a plant growing kit and a childâ€™s breakfast set:
<img src="/project_online-retail-sales/Country-drill-down-Norway.PNG" alt="Drill down Norway"></p>
<p>Some possible recommendations that could be given based on the information weâ€™ve found:</p>
<ul>
<li>
<p>Since there is seen an increase of sales in the months leading up to Christmas, the business can consider running special promotions, have extra staff capacity in areas like customer service, and make sure that the stock of the popular items are sufficient in the final quarter of the year.</p>
</li>
<li>
<p>Since different products are popular in different countries: If inventories are kept in different warehouses in different locations in the world, stock in the different warehouses can be adjusted based on what items are more popular in which countries.</p>
</li>
<li>
<p>Based on the information on the spending behavior of different customers, the business can implement targeted marketing campaigns for high-value customers. Though, I am not sure whether or not this is actually more effective for increasing sales compared to doing marketing campaigns for all of the customers in the data set. People specializing in marketing or business economics might be better equipped to know what actions are best to take based on this info.</p>
</li>
<li>
<p>The overall cancellation rate was found to be 18%, which seems pretty high. The business could investigate reasons for cancellations. If that is difficult with the current data they have, they could implement systematic ways to gather information about cancellations. For example, upon cancelling an order, customers could be given the option to provide the reason for the cancellation. This info could indicate what to do to reduce the cancellation rate, like improving product descriptions.</p>
</li>
</ul>
<p>Gathering data about customer satisfaction for each order, such as a satisfaction score, could be beneficial for e.g. improving marketing strategies and for understanding cancellations trends.</p>
<p>Continuing to collect sales data would also naturally be recommended. Having sales data for more years would be beneficial for getting a better understanding of what are real trends, what are random fluctuations, and perhaps also other relationships between sales and various events in the market or in the world that only become apparrent when having more years of data to compare with.</p> </div> </article>  </main> <footer class="w-full max-w-3xl mx-auto pt-12 pb-10 sm:pt-24 sm:pb-14">  <div class="pt-6 flex flex-col gap-4 border-t border-dashed border-main sm:flex-row-reverse sm:justify-between sm:items-center"> <div class="flex flex-wrap gap-x-4 gap-y-1"> <a class="inline-flex items-center justify-center text-sm hover:underline hover:underline-offset-2" href="/contact" target="_blank" rel="noopener noreferer"> Contact </a><a class="inline-flex items-center justify-center text-sm hover:underline hover:underline-offset-2" href="https://www.linkedin.com/in/amund-fredriksen-42a253297/" target="_blank" rel="noopener noreferer"> LinkedIn </a> </div> <!-- <p class="text-sm">
            &copy; {new Date().getFullYear()}&nbsp;<a class="hover:underline hover:underline-offset-2" href="/">{siteConfig.title}</a>. All rights reserved.
        </p> --> </div> </footer> </div> </body></html>